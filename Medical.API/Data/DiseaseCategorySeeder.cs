using Medical.API.Models.Entities;
using Microsoft.EntityFrameworkCore;

namespace Medical.API.Data;

/// <summary>
/// 疾病分类数据种子（根据科室插入对应的疾病）
/// </summary>
public static class DiseaseCategorySeeder
{
    /// <summary>
    /// 初始化疾病分类数据
    /// </summary>
    public static async Task SeedAsync(MedicalDbContext context)
    {
        // 检查是否已有疾病分类数据
        var existingCount = await context.DiseaseCategories.CountAsync();
        if (existingCount > 0)
        {
            return; // 已有数据，不重复插入
        }

        // 获取所有科室
        var departments = await context.Departments.ToListAsync();
        if (departments.Count == 0)
        {
            return; // 没有科室数据，无法插入疾病分类
        }

        var diseaseCategories = new List<DiseaseCategory>();

        // 根据科室名称匹配对应的疾病（确保与 DepartmentSeeder 中的科室名称完全一致）
        foreach (var department in departments)
        {
            var diseases = GetDiseasesByDepartment(department.Name);
            // 如果科室没有匹配到疾病，跳过（避免为医技科室创建空记录）
            if (diseases.Count == 0)
            {
                continue;
            }
            foreach (var disease in diseases)
            {
                diseaseCategories.Add(new DiseaseCategory
                {
                    Id = Guid.NewGuid(),
                    DepartmentId = department.Id,
                    Name = disease.Name,
                    Symptoms = disease.Symptoms,
                    CreatedAt = DateTime.UtcNow
                });
            }
        }

        if (diseaseCategories.Count > 0)
        {
            context.DiseaseCategories.AddRange(diseaseCategories);
            await context.SaveChangesAsync();
        }
    }

    /// <summary>
    /// 根据科室名称获取对应的疾病列表
    /// </summary>
    private static List<(string Name, string? Symptoms)> GetDiseasesByDepartment(string departmentName)
    {
        return departmentName switch
        {
            "心血管内科" => new List<(string, string?)>
            {
                ("冠心病", "胸痛、胸闷、心悸、气短、乏力"),
                ("高血压", "头痛、头晕、心悸、耳鸣、失眠"),
                ("心律失常", "心悸、胸闷、头晕、乏力、晕厥"),
                ("心力衰竭", "呼吸困难、水肿、乏力、咳嗽、心悸"),
                ("心肌梗死", "剧烈胸痛、呼吸困难、恶心、出汗、焦虑")
            },
            "呼吸内科" => new List<(string, string?)>
            {
                ("肺炎", "发热、咳嗽、咳痰、胸痛、呼吸困难"),
                ("哮喘", "喘息、咳嗽、胸闷、气短、夜间症状加重"),
                ("慢阻肺", "慢性咳嗽、咳痰、气短、喘息、胸闷"),
                ("肺癌", "咳嗽、咳血、胸痛、呼吸困难、体重下降"),
                ("支气管炎", "咳嗽、咳痰、胸闷、气短、发热")
            },
            "消化内科" => new List<(string, string?)>
            {
                ("胃炎", "上腹痛、腹胀、恶心、呕吐、食欲不振"),
                ("胃溃疡", "上腹痛、餐后痛、反酸、嗳气、黑便"),
                ("肝炎", "乏力、食欲不振、黄疸、肝区疼痛、恶心"),
                ("肝硬化", "乏力、腹胀、黄疸、腹水、消化道出血"),
                ("胰腺炎", "上腹痛、恶心、呕吐、发热、黄疸")
            },
            "神经内科" => new List<(string, string?)>
            {
                ("脑梗塞", "偏瘫、失语、感觉障碍、眩晕、头痛"),
                ("脑出血", "剧烈头痛、呕吐、偏瘫、意识障碍、血压升高"),
                ("癫痫", "抽搐、意识丧失、口吐白沫、双眼上翻"),
                ("帕金森病", "震颤、肌强直、运动迟缓、姿势平衡障碍"),
                ("痴呆", "记忆力减退、认知障碍、行为异常、生活能力下降")
            },
            "内分泌科" => new List<(string, string?)>
            {
                ("糖尿病", "多饮、多食、多尿、体重下降、乏力"),
                ("甲状腺功能亢进", "心悸、多汗、手抖、消瘦、易怒"),
                ("甲状腺功能减退", "乏力、怕冷、体重增加、记忆力减退、便秘"),
                ("骨质疏松", "骨痛、身高变矮、易骨折、驼背"),
                ("痛风", "关节红肿热痛、活动受限、高尿酸血症")
            },
            "肾内科" => new List<(string, string?)>
            {
                ("肾炎", "水肿、血尿、蛋白尿、高血压、乏力"),
                ("肾病综合征", "大量蛋白尿、低蛋白血症、水肿、高脂血症"),
                ("肾衰竭", "乏力、恶心、水肿、贫血、高血压"),
                ("尿路感染", "尿频、尿急、尿痛、发热、腰痛"),
                ("肾结石", "腰痛、血尿、恶心、呕吐、尿频")
            },
            "血液内科" => new List<(string, string?)>
            {
                ("贫血", "乏力、头晕、心悸、面色苍白、气短"),
                ("白血病", "发热、出血、贫血、淋巴结肿大、骨痛"),
                ("淋巴瘤", "淋巴结肿大、发热、盗汗、体重下降、乏力"),
                ("血小板减少症", "出血倾向、皮肤瘀点、鼻出血、牙龈出血"),
                ("血友病", "关节出血、肌肉出血、皮肤瘀斑、术后出血不止")
            },
            "风湿免疫科" => new List<(string, string?)>
            {
                ("类风湿关节炎", "关节疼痛、肿胀、晨僵、关节畸形、活动受限"),
                ("系统性红斑狼疮", "面部蝶形红斑、关节痛、发热、乏力、光敏感"),
                ("强直性脊柱炎", "腰背痛、晨僵、活动受限、关节疼痛、疲劳"),
                ("干燥综合征", "口干、眼干、关节痛、乏力、皮肤干燥"),
                ("痛风性关节炎", "关节红肿热痛、活动受限、高尿酸血症")
            },
            "感染科" => new List<(string, string?)>
            {
                ("病毒性肝炎", "乏力、食欲不振、黄疸、肝区疼痛、恶心"),
                ("艾滋病", "发热、乏力、淋巴结肿大、体重下降、机会性感染"),
                ("结核病", "咳嗽、咳痰、低热、盗汗、乏力、体重下降"),
                ("发热待查", "持续发热、乏力、头痛、肌肉酸痛"),
                ("细菌感染", "发热、寒战、局部红肿热痛、白细胞升高")
            },
            "普通外科" => new List<(string, string?)>
            {
                ("阑尾炎", "右下腹痛、恶心、呕吐、发热、压痛"),
                ("胆囊炎", "右上腹痛、恶心、呕吐、发热、黄疸"),
                ("疝气", "腹股沟肿块、疼痛、坠胀感、活动后加重"),
                ("甲状腺结节", "颈部肿块、吞咽困难、声音嘶哑、压迫感"),
                ("乳腺疾病", "乳房肿块、疼痛、乳头溢液、皮肤改变")
            },
            "骨科" => new List<(string, string?)>
            {
                ("骨折", "局部疼痛、肿胀、畸形、活动受限、骨擦音"),
                ("关节炎", "关节疼痛、肿胀、活动受限、晨僵"),
                ("腰椎间盘突出", "腰痛、下肢放射痛、麻木、活动受限"),
                ("颈椎病", "颈痛、上肢麻木、头晕、头痛、活动受限"),
                ("骨质疏松", "骨痛、易骨折、身高变矮、驼背")
            },
            "神经外科" => new List<(string, string?)>
            {
                ("脑肿瘤", "头痛、呕吐、视力下降、癫痫、偏瘫"),
                ("脑外伤", "头痛、意识障碍、恶心、呕吐、神经功能缺损"),
                ("脑血管病", "偏瘫、失语、感觉障碍、眩晕、头痛"),
                ("脊柱脊髓疾病", "肢体麻木、无力、疼痛、大小便障碍"),
                ("颅内感染", "头痛、发热、意识障碍、脑膜刺激征")
            },
            "胸外科" => new List<(string, string?)>
            {
                ("肺癌", "咳嗽、咳血、胸痛、呼吸困难、体重下降"),
                ("食管癌", "吞咽困难、胸痛、体重下降、声音嘶哑"),
                ("纵隔肿瘤", "胸闷、气短、咳嗽、胸痛、压迫症状"),
                ("气胸", "突发胸痛、呼吸困难、咳嗽、胸闷"),
                ("胸腔积液", "呼吸困难、咳嗽、胸痛、胸闷")
            },
            "泌尿外科" => new List<(string, string?)>
            {
                ("肾结石", "腰痛、血尿、恶心、呕吐、尿频"),
                ("前列腺疾病", "尿频、尿急、尿痛、排尿困难、血尿"),
                ("膀胱肿瘤", "血尿、尿频、尿急、尿痛、排尿困难"),
                ("男性不育", "精液异常、性功能障碍、无精子症"),
                ("泌尿系感染", "尿频、尿急、尿痛、发热、腰痛")
            },
            "心脏外科" => new List<(string, string?)>
            {
                ("先天性心脏病", "心悸、气短、发绀、活动受限、反复感染"),
                ("心脏瓣膜病", "心悸、气短、乏力、水肿、心律失常"),
                ("冠心病", "胸痛、胸闷、心悸、气短、乏力"),
                ("主动脉瘤", "胸痛、背痛、呼吸困难、声音嘶哑、压迫症状"),
                ("心脏肿瘤", "心悸、气短、心律失常、栓塞、心衰")
            },
            "血管外科" => new List<(string, string?)>
            {
                ("动脉硬化", "肢体疼痛、间歇性跛行、皮肤温度降低、脉搏减弱"),
                ("静脉曲张", "下肢静脉曲张、疼痛、肿胀、皮肤色素沉着"),
                ("主动脉瘤", "胸痛、背痛、呼吸困难、声音嘶哑、压迫症状"),
                ("血管畸形", "局部肿块、疼痛、出血、压迫症状"),
                ("深静脉血栓", "肢体肿胀、疼痛、皮肤温度升高、活动受限")
            },
            "整形外科" => new List<(string, string?)>
            {
                ("烧伤", "皮肤红肿、水疱、疼痛、感染、瘢痕"),
                ("手外伤", "手部疼痛、肿胀、活动受限、感觉异常"),
                ("先天性畸形", "外观异常、功能受限、心理影响"),
                ("瘢痕", "皮肤瘢痕、瘙痒、疼痛、影响外观"),
                ("体表肿瘤", "皮肤肿块、疼痛、出血、影响外观")
            },
            "烧伤科" => new List<(string, string?)>
            {
                ("烧伤", "皮肤红肿、水疱、疼痛、感染、瘢痕"),
                ("烫伤", "皮肤红肿、水疱、疼痛、感染、瘢痕"),
                ("电击伤", "皮肤烧伤、心律失常、意识障碍、肌肉损伤"),
                ("化学烧伤", "皮肤损伤、疼痛、感染、瘢痕、功能障碍")
            },
            "妇科" => new List<(string, string?)>
            {
                ("妇科肿瘤", "异常出血、腹痛、腹部肿块、白带异常"),
                ("妇科炎症", "白带异常、外阴瘙痒、腹痛、性交痛"),
                ("月经不调", "月经周期异常、经量异常、痛经"),
                ("不孕不育", "不孕、月经异常、内分泌失调"),
                ("子宫内膜异位症", "痛经、性交痛、不孕、月经异常")
            },
            "产科" => new List<(string, string?)>
            {
                ("妊娠高血压", "高血压、蛋白尿、水肿、头痛、视力模糊"),
                ("妊娠糖尿病", "血糖升高、多饮、多食、多尿、体重异常"),
                ("早产", "宫缩、腹痛、阴道流血、胎膜早破"),
                ("产后出血", "阴道大量出血、休克、贫血、乏力"),
                ("产褥感染", "发热、腹痛、恶露异常、子宫压痛")
            },
            "计划生育科" => new List<(string, string?)>
            {
                ("人工流产", "妊娠终止、出血、腹痛、感染风险"),
                ("节育手术", "避孕、手术风险、术后恢复"),
                ("避孕指导", "避孕方法选择、副作用、注意事项")
            },
            "小儿内科" => new List<(string, string?)>
            {
                ("小儿肺炎", "咳嗽、发热、呼吸困难、食欲不振、烦躁"),
                ("小儿腹泻", "腹泻、呕吐、脱水、发热、食欲不振"),
                ("小儿哮喘", "喘息、咳嗽、胸闷、气短、夜间症状加重"),
                ("小儿癫痫", "抽搐、意识丧失、口吐白沫、双眼上翻"),
                ("小儿贫血", "乏力、面色苍白、食欲不振、发育迟缓")
            },
            "小儿外科" => new List<(string, string?)>
            {
                ("先天性畸形", "外观异常、功能受限、发育异常"),
                ("小儿肿瘤", "肿块、疼痛、体重下降、乏力"),
                ("小儿外伤", "疼痛、肿胀、活动受限、出血"),
                ("小儿急腹症", "腹痛、呕吐、发热、腹胀"),
                ("小儿泌尿系疾病", "尿频、尿急、尿痛、血尿、排尿困难")
            },
            "新生儿科" => new List<(string, string?)>
            {
                ("早产儿", "低出生体重、呼吸窘迫、喂养困难、感染风险"),
                ("新生儿黄疸", "皮肤黄染、巩膜黄染、食欲不振、嗜睡"),
                ("新生儿肺炎", "呼吸困难、咳嗽、发热、食欲不振"),
                ("新生儿窒息", "呼吸暂停、发绀、心率下降、意识障碍"),
                ("新生儿感染", "发热、食欲不振、黄疸、呼吸异常")
            },
            "眼科" => new List<(string, string?)>
            {
                ("白内障", "视力下降、视物模糊、眩光、色觉异常"),
                ("青光眼", "眼痛、头痛、视力下降、视野缺损、恶心"),
                ("眼底病", "视力下降、视物变形、视野缺损、飞蚊症"),
                ("屈光不正", "视力下降、视物模糊、眼疲劳、头痛"),
                ("眼外伤", "眼痛、视力下降、眼红、流泪、异物感")
            },
            "耳鼻喉科" => new List<(string, string?)>
            {
                ("中耳炎", "耳痛、听力下降、耳流脓、耳鸣、发热"),
                ("鼻炎", "鼻塞、流涕、打喷嚏、鼻痒、嗅觉下降"),
                ("鼻窦炎", "鼻塞、流脓涕、头痛、嗅觉下降、面部疼痛"),
                ("咽喉炎", "咽痛、声音嘶哑、咳嗽、异物感、吞咽困难"),
                ("听力障碍", "听力下降、耳鸣、眩晕、平衡障碍")
            },
            "口腔科" => new List<(string, string?)>
            {
                ("牙病", "牙痛、牙龈出血、牙齿松动、口臭"),
                ("口腔黏膜病", "口腔溃疡、疼痛、影响进食、反复发作"),
                ("口腔颌面外科", "面部肿块、疼痛、张口受限、影响功能"),
                ("正畸", "牙齿排列不齐、影响美观、咬合异常"),
                ("口腔肿瘤", "口腔肿块、疼痛、出血、影响功能")
            },
            "皮肤科" => new List<(string, string?)>
            {
                ("湿疹", "皮肤瘙痒、红斑、丘疹、水疱、糜烂"),
                ("皮炎", "皮肤瘙痒、红斑、脱屑、疼痛"),
                ("银屑病", "红斑、鳞屑、瘙痒、关节痛、影响外观"),
                ("白癜风", "皮肤白斑、影响外观、心理影响"),
                ("性病", "皮肤损害、疼痛、瘙痒、影响健康")
            },
            "精神科" => new List<(string, string?)>
            {
                ("抑郁症", "情绪低落、兴趣减退、乏力、失眠、食欲下降"),
                ("焦虑症", "焦虑、紧张、恐惧、心悸、出汗、失眠"),
                ("精神分裂症", "幻觉、妄想、思维混乱、行为异常、情感淡漠"),
                ("睡眠障碍", "失眠、多梦、早醒、睡眠质量差、白天困倦"),
                ("强迫症", "强迫思维、强迫行为、焦虑、影响生活")
            },
            "康复医学科" => new List<(string, string?)>
            {
                ("脑卒中后遗症", "偏瘫、失语、感觉障碍、认知障碍、生活能力下降"),
                ("脊髓损伤", "肢体瘫痪、感觉障碍、大小便障碍、活动受限"),
                ("骨折后康复", "关节活动受限、肌肉萎缩、疼痛、功能恢复"),
                ("运动损伤", "疼痛、肿胀、活动受限、功能恢复"),
                ("言语障碍", "失语、构音障碍、吞咽困难、影响交流")
            },
            "中医科" => new List<(string, string?)>
            {
                ("中医内科", "辨证论治、整体调理、慢性病治疗"),
                ("中医外科", "疮疡、皮肤病、外伤、中医外治法"),
                ("针灸", "疼痛、功能障碍、慢性病、亚健康调理"),
                ("推拿", "疼痛、功能障碍、慢性病、亚健康调理"),
                ("中药", "辨证论治、整体调理、慢性病治疗、养生保健")
            },
            "急诊科" => new List<(string, string?)>
            {
                ("急危重症", "生命体征不稳定、意识障碍、多器官功能衰竭"),
                ("创伤急救", "外伤、出血、疼痛、休克、功能障碍"),
                ("中毒", "恶心、呕吐、腹痛、意识障碍、生命体征异常"),
                ("急性心梗", "剧烈胸痛、呼吸困难、心律失常、休克"),
                ("急性脑卒中", "突发偏瘫、失语、意识障碍、头痛、呕吐")
            },
            "重症医学科" => new List<(string, string?)>
            {
                ("多器官功能衰竭", "多器官功能异常、生命体征不稳定、需要生命支持"),
                ("呼吸衰竭", "呼吸困难、低氧血症、需要呼吸机支持"),
                ("循环衰竭", "休克、低血压、心律失常、需要循环支持"),
                ("急性肾衰竭", "少尿、无尿、水肿、电解质紊乱、需要透析"),
                ("严重感染", "发热、休克、多器官功能异常、需要抗感染治疗")
            },
            "麻醉科" => new List<(string, string?)>
            {
                ("手术麻醉", "手术麻醉、术后镇痛、麻醉并发症"),
                ("疼痛治疗", "慢性疼痛、癌痛、神经痛、疼痛管理"),
                ("无痛分娩", "分娩镇痛、产妇舒适、胎儿安全"),
                ("无痛胃肠镜", "检查舒适、减少痛苦、提高检查质量")
            },
            "医学影像科" => new List<(string, string?)>
            {
                ("X线检查", "影像检查、疾病诊断、辅助检查"),
                ("CT检查", "影像检查、疾病诊断、辅助检查"),
                ("MRI检查", "影像检查、疾病诊断、辅助检查"),
                ("超声检查", "影像检查、疾病诊断、辅助检查"),
                ("核医学检查", "影像检查、疾病诊断、辅助检查")
            },
            "检验科" => new List<(string, string?)>
            {
                ("血液检验", "血常规、生化检验、疾病诊断、辅助检查"),
                ("生化检验", "肝功能、肾功能、血糖、血脂、疾病诊断"),
                ("免疫检验", "免疫功能、自身抗体、疾病诊断、辅助检查"),
                ("微生物检验", "细菌培养、药敏试验、感染诊断、辅助检查")
            },
            "病理科" => new List<(string, string?)>
            {
                ("组织病理", "组织病理诊断、疾病诊断、辅助检查"),
                ("细胞病理", "细胞病理诊断、疾病诊断、辅助检查"),
                ("免疫病理", "免疫病理诊断、疾病诊断、辅助检查"),
                ("分子病理", "分子病理诊断、疾病诊断、辅助检查")
            },
            "药剂科" => new List<(string, string?)>
            {
                ("药品管理", "药品采购、储存、调剂、管理"),
                ("临床药学", "用药指导、药物监测、不良反应监测"),
                ("药品不良反应", "药物不良反应、用药安全、监测管理")
            },
            _ => new List<(string, string?)>() // 默认返回空列表
        };
    }
}

